"use strict";let onUnload=function(){event.returnValue=1};window.addEventListener("dragover",function(){event.preventDefault()}),window.addEventListener("drop",function(){event.preventDefault()}),document.querySelector("body").addEventListener("click",function(a){let b=a.target;if(-1==b.className.search("menu")&&-1==b.className.search("status")&&"I"!=b.nodeName){let a=document.querySelectorAll("input[class='menu']");[].filter.call(a,function(a){a.checked=!1})}});
let searchResult=document.querySelector("#map-result"),searchBtn=document.querySelector("#map-search-button"),searchBox=document.querySelector("#map-search-box"),searchToggle=document.querySelector("#map-search");function mapSearch(a){let b=new XMLHttpRequest,c="",d="",e=0;b.open("get","/map/search?keyword="+a.value,!0),b.onload=function(){if(200<=this.status&&400>this.status){if(d=JSON.parse(this.response),e=d?d.map.length:null,null!=e){let a=[];for(let b,f=0;f<e;f++){b=d.place[f].split("&"),a.country=d.country[f];for(let c=0;c<b.length;c++)a[b[c].split(":")[0]]=b[c].split(":")[1];let e=a.country.split("|")[0]+" "+a.locality.split("|")[0]+" "+a.political1.split("|")[0]+" "+a.political2.split("|")[0]+(a.political3?" "+a.political3.split("|")[0]:""),g=(a.political3?" "+a.political3.split("|")[0]:"")+", "+a.political2.split("|")[1]+", "+a.political1.split("|")[1]+", "+a.locality.split("|")[1]+", "+a.country;c+="<a href='/"+d.map[f]+"'><li class='org'>"+e+"</li><li class='rev'>"+g+"</li></a>"}}else c="<a href='#'><li>No Results</li></a>";searchResult.innerHTML=c}else searchResult.innerHTML="No Results"},b.onprogress=function(){},b.onerror=function(){},b.send()}searchBtn&&searchBtn.addEventListener("click",function(){searchToggle.checked=!1,mapSearch(searchBox)}),searchBox&&searchBox.addEventListener("keydown",function(a){""==searchBox.value&&(searchToggle.checked=!1,searchResult.innerHTML="<a href='#'><li>No Results</li></a>"),"13"==a.keyCode&&(searchToggle.checked=!0,mapSearch(this))});
let signin=document.querySelector("#sign-in");function signInCheck(a){let b=new FormData(a),c=new XMLHttpRequest,d="";c.open("post","/sign/in/check",!0),c.onload=function(){200<=this.status&&400>this.status&&(d=JSON.parse(this.response),d.valid?a.submit():alert(d.msg))},c.onprogress=function(){},c.onerror=function(){},c.send(b)}signin&&signin.addEventListener("submit",function(){event.preventDefault(),signInCheck(signin)});
let type=document.querySelector('#status-type'),place=document.querySelector('#status-place');type&&place&&type.addEventListener('change',function(){let a='';'#'===type.value&&(a='/'+place.innerHTML),a='/'+place.innerHTML+'/'+type.value+'/list',window.location.href=a});