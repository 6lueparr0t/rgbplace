"use strict";var replyBox=document.querySelectorAll(".reply-button:not(.no):not(.yes)"),replyBoxNo=document.querySelectorAll(".reply-button.no"),replyBoxYes=document.querySelectorAll(".reply-button.yes");function replyTemplate(a,b,c){var d=document.createElement("li");return d.className="reply-container",d.innerHTML="<div class='reply-addon block'><input type='hidden' class='reply-no' value='"+a+"'/><input type='hidden' class='reply-mode' value='"+b+"'/><textarea class='reply-box' id='reply-box-"+a+"' placeholder='Leave a Message ...'>"+c+"</textarea><div class='reply-button-group'><div class='reply-button send to'>Reply on Message <span style='font-weight:900;transform: translate(.4rem,.1rem);'>&#xf11c;</span></div><div class='reply-button yes to'>Confirm</div><div class='reply-button no to'>Not Yet ..</div><div class='reply-button cancel'>Cancel</div></div>",+"</div>",d}function getReplyPaging(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null;httpRequest("GET","/api/request/reply?info="+__URL__+"&page="+a,null,refresh.bind(b),fail.bind(b))}function replyBoxToggle(a){a?(this.style.display="none",this.nextSibling.style.display="initial",this.nextSibling.nextSibling.style.display="initial"):(this.style.display="none",this.previousSibling.style.display="none",this.previousSibling.previousSibling.style.display="initial")}document.querySelector("body").addEventListener("click",function(a){var b=a.target;if("BODY"===b.tagName)return!1;if("I"===b.tagName&&(b=b.parentElement),"reply-pagination"===b.parentElement.className){var c=b.getAttribute("data");getReplyPaging(c)}var d,e,f="",g="POST",h=[];switch(b.className.trim()){case"far fa-thumbs-up post-up enable":case"far fa-thumbs-up post-up enable active":this.act="up",h.push({info:__URL__,target:"POST",act:this.act}),httpRequest(g,"/api/request/vote/post",JSON.stringify(h),successPostVote.bind(this),fail.bind(this));break;case"far fa-thumbs-down post-down enable":case"far fa-thumbs-down post-down enable active":this.act="down",h.push({info:__URL__,target:"POST",act:this.act}),httpRequest(g,"/api/request/vote/post",JSON.stringify(h),successPostVote.bind(this),fail.bind(this));break;case"far fa-thumbs-up reply-up enable":case"far fa-thumbs-up reply-up enable active":d=b.parentElement.parentElement.parentElement,d.act="up",h.push({info:__URL_ARRAY__[0]+"/"+__URL_ARRAY__[1]+"/"+__URL_ARRAY__[2]+"/"+d.querySelector(".no").innerHTML,target:"REPLY",act:d.act}),httpRequest(g,"/api/request/vote/reply",JSON.stringify(h),successReplyVote.bind(d),fail.bind(d));break;case"far fa-thumbs-down reply-down enable":case"far fa-thumbs-down reply-down enable active":d=b.parentElement.parentElement.parentElement,d.act="down",h.push({info:__URL_ARRAY__[0]+"/"+__URL_ARRAY__[1]+"/"+__URL_ARRAY__[2]+"/"+d.querySelector(".no").innerHTML,target:"REPLY",act:d.act}),httpRequest(g,"/api/request/vote/reply",JSON.stringify(h),successReplyVote.bind(d),fail.bind(d));break;case"report enable":d=b.parentElement.parentElement.parentElement,d.act="report",h.push({info:__URL_ARRAY__[0]+"/"+__URL_ARRAY__[1]+"/"+__URL_ARRAY__[2]+"/"+d.querySelector(".no").innerHTML,target:"REPLY",act:d.act}),httpRequest(g,"/api/request/report",JSON.stringify(h),successReport.bind(d),fail.bind(d));break;case"reply enable":case"reply enable show":case"reply-modify enable":case"reply-modify enable show":d=b.parentElement.parentElement.parentElement.parentElement,e=d.querySelector("ul .no").innerHTML,b.classList.contains("reply-modify")&&(f=d.querySelector("ul .content .text").innerHTML.replace(/<a href=[\x22\x27](.*)[\x22\x27] target=".*">(.*)<\/a>/gm,"$1").replace(/<br\s*\/?>/mg,"\n"),d.querySelector("ul").classList.toggle("hide"),g="UPDATE"),b.classList.toggle("show"),0===d.lastChild.className.search("reply-container")?(d.removeChild(d.lastChild),"UPDATE"==g&&d.appendChild(replyTemplate(e,g,f))):d.appendChild(replyTemplate(e,g,f));break;case"reply-delete enable":if(confirm("\uC0AD\uC81C \u3131\u3131?\nRemove this reply?")){d=b.parentElement.parentElement.parentElement.parentElement;var i=d.previousSibling?d.previousSibling.querySelector("ul .no").innerHTML:null;e=d.querySelector("ul .no").innerHTML,g="DELETE",h.push({info:__URL__,no:e}),httpRequest(g,"/api/request/reply",JSON.stringify(h),success.bind(i),fail.bind(this))}break;case"reply-button cancel":var j=b.parentElement.parentElement.parentElement.parentElement;j.querySelector(".reply.enable").classList.remove("show"),j.querySelector("ul").classList.remove("hide"),j.removeChild(j.lastChild);break;case"reply-button send to":case"reply-button send":replyBoxToggle.call(b,!0);break;case"reply-button yes to":case"reply-button yes":if(d=b.parentElement.parentElement,e=d.querySelector(".reply-no").value,g=d.querySelector(".reply-mode").value,f=d.querySelector(".reply-box"),!f.value){f.setCustomValidity("\uD83D\uDE33\uD83D\uDCAC"),f.reportValidity(),setTimeout(function(){this.setCustomValidity("")}.bind(f),1e3);break}h.push({info:__URL__,no:e,message:f.value}),httpRequest(g,"/api/request/reply",JSON.stringify(h),success.bind(null),fail.bind(f));break;case"reply-button no to":case"reply-button no":replyBoxToggle.call(b,!1);break;case"delete enable":confirm("\uAE00\uC744 \uC0AD\uC81C\uD558\uACA0\uC2B5\uB2C8\uAE4C? \uBCF5\uAD6C\uAC00 \uB418\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4!\nRemove this post? can not restore it!")&&(h.push({info:__URL__}),httpRequest("delete","/api/request/post",JSON.stringify(h),successDelete.bind(this),fail.bind(this)));}switch(b.id){case"link-copy":var k=document.getElementById(b.id);if(document.body.createTextRange){var l=document.body.createTextRange();l.moveToElementText(k),l.select(),document.execCommand("Copy"),document.selection.empty()}else if(window.getSelection){var m=window.getSelection(),n=document.createRange();n.selectNodeContents(k),m.removeAllRanges(),m.addRange(n),document.execCommand("Copy"),m.removeAllRanges()}else break;var o=b.nextSibling;showTooltip(o,"fadeInOutUp");}});function success(a){getReplyPaging(a,this)}function successDelete(){alert("\uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.\nPost was Deleted"),redirect("list")}function successReplyVote(a){-1<a&&(this.querySelector(".reply-"+this.act+".enable").innerHTML=" "+a+" ",this.querySelector(".reply-"+this.act+".enable").classList.toggle("active"))}function successPostVote(a){if(-1<a){document.querySelector(".post-"+this.act+".enable").innerHTML=" "+a+" ",document.querySelector(".post-"+this.act+".enable").classList.toggle("active");["trip","food","daily","play","romance","news","dev"].includes(__URL_ARRAY__[2])&&20<a&&"up"===this.act&&(alert("\uD83D\uDE0E"),redirect(__URL_ARRAY__[3],"best"))}}function successReport(a){-1<a?alert("\uD83D\uDD76\uFE0F \uC2E0\uACE0 \uC644\uB8CC ! \uD83D\uDC4A\nReport Success!"):alert("\uC2E0\uACE0 \u3134\u3134\nCould not report")}function refresh(a){a&&(document.querySelector(".reply-root").innerHTML=a),this&&move("#reply-"+this,-200)}function fail(a){var b=this;b.setCustomValidity(a.responseText),b.reportValidity(),setTimeout(function(){this.setCustomValidity("")}.bind(b),1e3)}!function(){var a=new URL(window.location),b=a.searchParams.get("no"),c=b?"&no="+b:"";"no_reply"!=document.querySelector("#reply").className&&httpRequest("GET","/api/request/reply?info="+__URL__+c,null,refresh.bind(b),fail.bind(this))}();